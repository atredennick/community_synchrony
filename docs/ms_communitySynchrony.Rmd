---
layout: 12pt
header-includes:
   - \usepackage{lineno}
   - \linenumbers
   - \usepackage{setspace}
   - \usepackage{todonotes}
   - \doublespacing
   - \usepackage[document]{ragged2e}
   - \usepackage{color}
   - \usepackage{rotating}
bibliography: ~/Dropbox/Bibliography/CommunitySynchrony.bib
csl: components/ecology.csl

## rmarkdown render options
output:
  pdf_document:
    fig_caption: true
    keep_tex: false
fontsize: 12pt
geometry: margin=1in
linkcolor: black
urlcolor: black
---
```{r caching, include=FALSE}
library("methods")
library("knitr")
basename <- "ms_communitySynchrony"
opts_chunk$set(fig.path = paste("components/figure/", basename, "-", sep=""),
               cache.path = paste("components/cache/", basename, "/", sep=""))
opts_chunk$set(cache = 2)
opts_chunk$set(tidy=FALSE, warning=FALSE, message=FALSE, 
               comment = NA, verbose = TRUE, echo=FALSE)

# PDF-based figures
opts_chunk$set(dev='pdf')
```

\begin{singlespace}

\begin{center}
\large{\textbf{Disentangling the drivers of species synchrony in natural grasslands: environmental forcing, demographic stochasticity, and interspecific interactions}}

\renewcommand*{\thefootnote}{\fnsymbol{footnote}}

\normalsize{Andrew T. Tredennick\textsuperscript{1}, Claire de Mazancourt\textsuperscript{2}, Michel Loreau\textsuperscript{2}, and Peter B. Adler\textsuperscript{1}}

\textit{\small{\textsuperscript{1}Department of Wildland Resources and the Ecology Center, 5230 Old Main Hill, Utah State University, Logan, Utah 84322 USA}}

\textit{\small{\textsuperscript{2}Centre for Biodiversity Theory and Modelling, Experimental Ecology Station, Centre National de la Recherche Scientifique, Moulis, 09200, France}}

\end{center}

\vspace{2em}

\textit{Keywords}: synchrony, compensatory dynamics, environmental stochasticity, demographic stochasticity, stability

\vspace{2em}

\textbf{Authorship}: ATT, CdM, and PBA designed the research, ATT performed the research, and ATT, CdM, ML, and PBA contributed to the analyses and interpretation of results. All authors contributed to writing the manuscript.

\textbf{Running Title}: Drivers of species synchrony in natural grasslands

\textbf{Article Type}: Letter

\textbf{Number of Words}: Abstract = ; Main Text = 

\textbf{Number of References}: 

\textbf{Number of Tables and Figures}:  2 Tables;  4 Figures

\textbf{Corresponding Author}: Andrew Tredennick \\  
Address: Department of Wildland Resources and the Ecology Center, 5230 Old Main Hill, Utah State University, Logan, Utah 84322 USA \\
Phone: +1-970-443-1599 \\
Fax: +1-435-797-3796 \\
Email: atredenn@gmail.com

\end{singlespace}
\renewcommand*{\thefootnote}{\arabic{footnote}}
\setcounter{footnote}{0}

\newpage{}

Abstract
-------------
Temporal asynchrony among interacting species is an important mechanism through which species richness can stabilize biomass production through time. 
While asynchrony is a key mechanism linking biodiversity and ecosystem function, empirical support for the prevalance of species asynchrony is mixed, and no studies have rigorously disentangled the forces driving species (a)synchrony in nature. 
We used stochastic, multi-species population models fit using long term datasets from five semi-arid grasslands to determine the relative importance of the three forces that drive species synchrony: environmental fluctuations, interspecific competition, and demographic stochasticity.
Species' environmental responses, quantified as temporal random effects in vital rate regressions, were positively correlated in each community, ranging from $\rho = 0.23$ to $\rho = 0.38$ when averaged over vital rates. 
As a result, community-wide synchrony of per capita growth rates ($\phi_r$), which ranges from 0 (perfect asynchrony) to 1 (perfect synchrony), was higher when environmental variation was present (average $\phi_r = 0.62$) rather than absent (average $\phi_r = 0.43$).
Removing interspecific competition, which was weak in all communities, did not affect synchrony, and demographic stochasticity only played a role in small populations.
Our results suggest that all five communities represent the theoretical limiting case where demographic stochasticity and competition are weak, and community-wide synchrony is approximately equal to the synchrony of species' environmental responses -- a result that may be quite general if natural communities tend to have large niche differences among species.
However, our results are in contrast to a recent analysis of several biodiversity-ecosystem function experiments, suggesting that strong transient competition early in community assembly can counteract the often synchronizing effect of environmental fluctuations.

\newpage{}
<!-- THIS HOW TO COMMENT-OUT -->
\setlength{\parindent}{5ex}

Introduction
------------
The relationship between species richness and ecosystem stability depends on species synchrony [@Gonzalez2009].
All else being equal, the stability of ecosystem function is highest when species dynamics are asynchronous [@DeMazancourt2013a].
Thus, a mechanistic understanding of the diversity-stability relationship requires understanding the processes that increase or decrease species synchrony in nature.
In the simplest case, when interspecific interactions and demographic stochasticity are weak, species synchrony is entirely determined by the synchrony of species' responses to fluctuating environmental conditions [@Loreau2008a; @Loreau2013].
Synchrony is highest when correlations among species' environmental responses are perfectly postive, intermediate when species' environmental responses are independent, and lowest when the correlations of species' environmental responses are perfectly negative [@Ives2002; @Loreau2008a; @Loreau2013].
Of course, real communities are subject to many internal and external forces beyond environmental fluctuations that can affect synchrony and complicate predictions from special theoretical cases [@Loreau2013].

Interspecific competition has long been considered a leading driver of species asynchrony (also called compensatory dynamics) [@Elton1942; @Tilman1988; @Ives1995]. 
If two species compete strongly, then fluctuating densities in one species leads to compensatory fluctuations in the densities of the other species [@Lehman2000].
Such countervailing fluctuations among competing species means that interspecific competition is typically a desynchronizing force on population abundances [@Loreau2013; @Gross2014].
However, interspecific competition can actually synchronize abundances when competition is weak and population growth rates are high [@Loreau2013].
Thus, the prevailing view that competition tends to decrease species synchrony [@Houlahan2007] is only true under certain assumptions [@Loreau2008a].

Along with environmental fluctuations and interspecific competition, demographic stochasticity can influence synchrony in small populations.
In the absence of all other forces, demographic stochasticity leads to independent species fluctuations and always desynchronizes population dynamics [@Loreau2008a; @DeMazancourt2013a]. 
Interestingly, most previous attempts to decipher the mechanisms behind species synchrony from observational time series relied on a null expectation of independent species fluctuations [e.g., @Houlahan2007].
A null expectation based on demographic stochasticity operating alone is problematic, however, because its effect is strong only in small populations.
In natural communities composed of large populations and exposed to environmental fluctuations and competition, independent species fluctuations should not be expected [@Loreau2008a].
Therefore, inferring the relative importance of competition or the environment based on positive or negative deviations from independent species fluctuations will lead to biased conclusions.
For example, @Houlahan2007 suggested that asynchronous population fluctuations are rare because they found generally positive correlations in species' abundances through time across a large number of ecosystems.
Based on that result and the null expecation that species should fluctuate independently, @Houlahan2007 concluded that abiotic factors synchronize species' abundances.
Thus, if populations are observed to covary positively through time, then the environment must be driving such synchronization.
But, if instead we *a priori* assume that species fluctuate in perfect synchrony [@Loreau2008a], judgment of whether species fluctate synchronously or not depends on the degree to which observed dynamics deviate from perfect synchrony. 

The fact that species synchrony emerges from complex interactions among species' environmental responses, species interactions, and demographic stochasticity makes it difficult to disentangle the drivers of synchrony in observational data, especially since an unbiased null expectation does not exist [@Loreau2008a].
Weak synchrony could reflect positive environmental correlations offset by strong competition, or weak environmental correlations and weak competition.
Likewise, demographic stochasticity can induce ecological drift in small populations that mask signals of competition and the environment [@Loreau2008a; @DeMazancourt2013a].
Even the metric used to quantify synchrony can cause confusion.
For example, @Ranta2008 showed that the most commonly used metric of species synchrony, community covariance, can be positive or negative in the presence or absence of strong competition.
Thus, it seems that understanding the processes leading to synchrony by analysing patterns alone is impossible.

One potential way forward is to use population models fit to empirical data to understand the influence of different drivers on species synchrony.
@Mutshinda2009 used such an approach by fitting a dynamic population model to several community time series of insect and bird abundances.
They used a statistical technique to decompose temporal variation into competition and environmental components, and found that postively correlated environmental responses among species determined community dynamics.
While a major step forward, Mutshinda et al.'s (2009) modeling technique relied on abundance data that may or may not reliably capture competitive interactions that occur at the individual level.
Thus, despite almost a decade of research aimed toward understanding species synchrony, we still lack direct tests that link environmental fluctuations, interspecific interactions, and demographic stochasticity to species synchrony in natural communities.

Here, we explicitly test theory on the drivers of species synchrony by parameterizing and simulating dynamic, multi-species population models fit to long term demographic data from five semi-arid grasslands [@Chu2015].
We use the fitted population models to simulate communities with and without the three processes identified by theory as drivers of species synchrony: interspecific interactions, environmental forcing, and demographic stochasticity [@Loreau2008a; @Loreau2013; @DeMazancourt2013a].
Our modeling approach allows us to draw inference from real ecological systems that would otherwise be impossible using strictly statistical [e.g., @Mutshinda2009], experimental [e.g., @Gross2014], or observational [e.g., @Houlahan2007] approaches.
Given that our models capture the essential features of community dynamics important to synchrony (density-dependence, demographic and environmental stochasticity) and that these models are able to reproduce observed plant abundances [@Chu2015], perturbing the models reveals the processes responsible for the degree of species synchrony in our focal grassland communities.
Our main focus is on the synchrony of species' per capita growth rates since they represent a species immediate response to environmental conditions and competition.
However, we also analyze synchrony of plant cover (a metric of abundance) to relate our findings to previous research.


Materials and Methods
---------------------
Our work relies on the data and analysis presented by @Chu2015. We refer interested readers to @Chu2015 for full details on the focal plant communities, choice of species, structure of vital rate statistical models, and the ability of fitted population models to reproduce observed dynamics. We offer a brief overview here, but note that the only difference between our vital rate models and those fit by @Chu2015 is that we allowed for positive species interactions. 

### Data
In the early 20th century, several range experiment stations in the western U.S. began mapping permanent quadrats, and conducted annual censuses for decades. 
We use such long-term demographic data sets from five semiarid grasslands in the western United States (described in detail by @Chu2015).
Each study site includes a set of 1-$\text{m}^2$ permanent quadrats within which all individual plants were identified and mapped annually using a pantograph (Hill 1920).
The resulting mapped polygons represent basal cover for grasses and canopy cover for shrubs.
Data come from the Sonoran desert in Arizona [@Anderson2012], sagebrush steppe in Idaho [@Zachmann2010], southern mixed prairie in Kansas [@Adler2007], northern mixed prairie in Montana [@Anderson2011], and Chihuahuan desert in New Mexico [Anderson et al. in preparation, @Chu2015] (Table 1).

### Analytical approach
Our analysis involved five steps for each study site:

1. Calculate observed and expected synchrony of per capita growth rates and percent cover
2. Fit statistical models for survival, growth, and recruitment
3. Build dynamic, multi-species population models: a spatially-implicit integral projection model (IPM; does not include demographic stochasticity) and a spatially-explicit individual based model (IBM; includes demographic stochasticity)
4. Remove interspecific interactions from IPM simulations to isolate the effect of environmental responses
5. Sequentially remove interspecific interactions, environmental fluctuations, and both (isolates effect of demographic stochasticity) from the IBM across a range of population sizes (effects strength of demographic stochasticity)

Our approach has several advantages.
First, we can use the models to directly compare synchrony from communities with and without different processes operating.
This means we do not have to rely on biased null expectations, such as independent species fluctuations, to determine if competition or environmental responses are more important -- we can test for this directly.
Second, our models represent natural communities, rather than experimentally-assembled communities.
This means our results may be more generalizable then results obtained from biodiversity-ecosystem function experiments where strong, but transient, competition is a hallmark [@Gross2014].
Third, our models are based on individual-level demographic data, which allows us to accurately estimate inter and intraspecific competition.
Lastly, we can use the models to estimate the synchrony of species' low density growth rates in the absence of interspecific competition.
Experimental analyses must rely on species' growth in monoculture as an indicator of a species' response to the environemnt, but low density growth rates are a direct measure of a species' immediate response to environmental conditions.

All our code and the data necessary to reproduce the results reported in this paper can be found on GitHub (link) as release v1.0, and we have archived that release on Dryad (link).

#### Calculating observed synchrony
The data consist of records for individual plant size in quadrats for each year.
To obtain estimates of percent cover for each focal species in each year, we summed the individual-level data within quadrats and then averaged percent cover, by species, over all quadrats.
We calculated per capita growth rates as $\text{log}(x_t) - \text{log}(x_{t-1})$, where *x* is species' percent cover in year *t*.
Using the community time series of per capita growth rates or percent cover, we calculated community synchrony using the metric of @Loreau2008a in the `synchrony' package [@Gouhier2014] in R [@R2013].
Specifically, we calculated synchrony as

\begin{equation}
\phi_x = \frac{\sigma^{2}_{T}}{(\sum_{i}\sigma_{x_{i}})^{2}}
\end{equation}

\noindent where $\sigma_{x_{i}}$ is the temporal variance of species *i*'s per capita population growth rate ($r_i$) or abundance ($N_i$) and $\sigma^{2}_{T}$ is the temporal variance of the aggregate community-level growth rate or abundance. $\phi$ ranges from 0 at perfect asynchrony to 1 at perfect synchrony [@Loreau2008a].

We chose to use the special theoretical case where only demographic stochasticity is operating and all species have similar growth rates and variances to serve as an expectation of synchrony (see Appendix X).
Specifically, based on a multi-species dynamic population model (Appendix X), we calculate expected synchrony of per capita growth rates ($\text{E}(\phi_r)$) as

\begin{equation}
\text{E}(\phi_r) = \frac{\sum_{i}p_{i}^{-1}}{\left(\sum_{i}p_{i}^{-1/2}\right)^{2}}
\end{equation}

\noindent and expected synchrony of percent cover ($\text{E}(\phi_N)$) as

\begin{equation}
\text{E}(\phi_N) = \frac{1}{\left(\sum_{i}p_{i}^{1/2}\right)^{2}}
\end{equation}

\noindent where $p_i$ is the average frequency of species *i* ($p_i = N_i/N_{Total}$).  

The difference between observed and expected synchrony represents the combined effect of competition and environmental stochasticity.
However, it is important to note that comparing observed and expected synchrony does not yield insight on the relative contributions of competition and environmental stochasticity.
The difference between observed and expected synchrony serves as a metric of how far natural communities are from idealized expectations.
To understand the influence of competition and environmental stochasticity, we must turn to using population model simulations.

#### Fitting statistical models
Vital rate regressions are the building blocks of our dynamic models (IBM and IPM).
We followed the approach of @Chu2015 to fit statistical models for survival, growth, and recruitment.
We modeled survival probability of each genet as function of genet size, temporal variation among years, permanent spatial variation among groups of quadrats, and local neighborhood crowding from conspecific and heterospecific genets.
Regression coefficients for the effect of crowding by each species can be considered a matrix of interaction coefficients whose diagonals represent intraspecific interations and whose off-diagonals represent interspecific interactions [@Adler2010].
We modeled growth as the change in size of a genet from one year to the next, which depends on the same factors as the survival model.
We fit the survival and growth regressions using INLA [@Rue2014], a statistical package for fitting generalized linear mixed effects models via approximate Bayesian inference [@Rue2009], in R [@R2013].
Genet size and crowding were treated as fixed effects; spatial (quadrat groupings) and temporal (interannual) variation were treated as random effects on the intercept.

We modeled recruitment at the quadrat scale, rather than the individual scale, because it is impossible to attribute new genets to specific parents [@Chu2015].
Our recruitment model assumes that the number of recruits produced in each year follows a negative binomial distribution with the mean dependent on the cover of the parent species, permanent spatial variation among groups, temporal variation among years, and inter- and intraspecific interactions as a function of total species' cover in the quadrat.
We fit the recruitment model using a hierarchical Bayesian approach implemented in JAGS [@Plummer2003] using the `rjags' package [@Plummer2014] in R.
Again, temporal and spatial variation were treated as random effects.

#### Building dynamic multi-species models
Once we have fit the vital rate stastical models, building the population models is straightforward.
For the IBM, we initialize the model by randomly assigning plants spatial coordinates, sizes and species identities until each species achieves a density representative of that observed in the data.
We then project the model forward by using the survival regression to determine whether a genet lives or dies, the growth regression to calculate changes in genet size, and the recruitment regression to add new individuals that are distributed randomly in space.
Crowding is directly calculated at each time step since each genet is spatially referenced (just like the actual data).
Demographic stochasticity is an inherent feature of IBMs because individuals with the very same probability of survival, for example, can have different fates.
The effect of demographic stochasticity on population dynamics depends on population size [@Lande2003], so we can control the strength of demographic stochasticity by simulating the IBM on different sized landscapes.
Environmental stochasticity is not an inherent feature of IBMs, but is easily included since we fit year-specific temporal random effects for each vital rate regression.
Thus, to include temporal environmental variation, at each time step we randomly choose a set of estimated survival, growth, and recruitment parameters specific to one observation year.
We can ignore the random year effects to exclude environmental stochasticity in the IBM.
For all simulations, we ignore the spatial random effect associated with variation among quadrat groups, so our simulations represent an average quadrat for each site.

The IPM is similar to the IBM in that it is built using the vital rate regressions [@Rees2009; @Rees2014], but it is different in that it is spatially-implicit and does not include demographic stochasticity.
Following @Chu2015, we use a mean field approximation that captures the essential features of spatial patterning to define the crowding index at each time step.
Temporal variation is included in exactly the same way as for the IBM.
For full details on the IPMs we use, see @Chu2015.


#### Removing interspecific interactions (IPM)
To remove interspecific interactions, we simply set the off-diagonals of the interaction matrix for each vital rate regression to zero.
This retains intraspecific interactions, and thus density-dependence, and results in simulations where species are effectively growing in monoculture.
We ran IPM simulations with interspecific interactions turned on/off for 2,000 time steps, after an initial 500 iteration burn-in period.
This allowed species time to reach their stable size distribution.
We then calculated the synchrony of species' percent cover and per capita growth rates (see *Calculating observed synchrony*) over 100 randomly selected contiguous 50 time step sections.
These simulations allowed us to isolate the effects of competition and environmental fluctuations in large populations where demographic stochasticity is absent.
Note, however, what we could not run IPM simulations without environmental fluctuations, because it is only those fluctuations that drive variability in stochastich IPMs.
In a constant environment, IPM simulations asymptote at stable equilibriums for each species.

#### Removing interspecific interactions and environmental fluctuations (IBM)
Since the IBM and IPM are driven by the same vital rate regressions, interspecific interactions were removed as described above for the IPM simulations.
To remove the effect of a fluctuating environment, we simply removed the temporal (interannual) random effects from the regression equations.
Thus, if we remove interspecific interactions and the temporal random effects, the only force causing population fluctutations through time is demographic stochasticity.
We ran a series of simulations for four "experiments": (1) environmental stochasticity on and interspecific interactions present, (2) environmental stochasticity off and interspecific interactions present, (3) environmental stochasticity on and interspecific interactions absent, and (4) environmental stochasticity off and interspecific interactions absent (only demographic stochasticity).
We ran IBM simulations for 100 time steps, and repeated the simulations 50 times for each "experiment" (interspecific interactions on/off with and without environmental stochasticity).
From those, we retained only the simulations in which no species went extinct due to demographic stochasticity.
Synchrony was calculated over the 100 time steps for each no extinction run within a model experiment.


Results
-------
Synchrony of species' per capita growth rates at our study sites ranged from 0.36 to 0.89 and synchrony of percent cover ranged from 0.15 to 0.92 (Table 2).
Synchrony tended to be higher in communities with few species (Arizona and New Mexico) and/or with relatively high temporal variability (e.g., Montana).
Synchrony was lowest in Idaho, the only data set that includes two life forms: a shrub and three perennial grasses (Table 1).
For per capita growth rates, all sites exhibited more synchronous dynamics than expected if only demographic stochasticity was operating (E($\phi_r$) < $\phi_r$ in Table 2).
The difference between observed $\phi_r$ and E($\phi_r$) represents the effect of the environmemt, species interactions, and species differences combined.
The combined effect of the environment, species interactions, and species differences is positive in all communities (E($\phi_c + \phi_e$) in Table 2), indicating a synchronizing effect of those forces that counter-balance the desynchronizing effect of demographic stochasticity.
In contrast, expected synchrony of percent cover was lower than expected if only demographic stochasticity was operating in two out of the five communities (Kansas and Idaho, Table 2).

For all five communities, species synchrony from IPM and IBM simulations closely approximated observed synchrony (Fig. 1), meaning that we can use the models to test the importance of different drivers of synchrony in these communities.
Removing interspecific interactions from the IPMs did not affect the synchrony of per capita growth rates (Fig. 2), likely because because interspecific interactions are weak in our focal communities (Table X1, and see @Chu2015).
For three out five communities, removing interspecific interactions had no effect on the synchrony of percent cover (Fig. 2a,c,d).
In the two communities where removing interspecific interactions did have an effect, synchrony of percent cover was higher when species interactions were absent (Fig. 2b,e).
We achieved similar results with the IBM simulations (Fig. 3).

Species' environmental responses, quantified as temporal random effects in vital rate regressions, were positively correlated in each community, ranging from $\rho = 0.23$ to $\rho = 0.38$ when averaged over vital rates (Appendix X).
Thus, removing environmental stochasticity caused synchrony of per capita growth rates to decrease in all five communities, whether interspecific interactions were present or not (Fig. 3, top panels, blue tones vs. orange tones).
Without environmental stochasticity or species interactions, synchrony of per capita growth rates all approximated the theoretical expectation of 1/*S*, where *S* is species richness, when only demographic stochasticity is operating (Fig. 3; top panels, dark blue lines).
In most cases, removing environmental stochasticity also led to a decrease in the synchrony of percent cover (Fig. 3; bottom panels).
The Montana community is the clear outlier, where synchrony of percent cover is virtually the same whether environmental fluctuations are present or not (Fig. 3).

Demographic stochasticity counteracted the synchronizing effect of the environment in only the smallest populations (Fig. 3).
The strength of demographic stochasticity decreased with the size of the simulated landscape in our IBMs.
Thus, in Figure 3 the strength of demographic stochasticity decreases along the x-axis.
In the absence of environmental stochasticity, the strength of demographic stochasticity has no impact of the synchrony of per capita growth rates or percent cover (Fig. 3, blue tones).
In the presence of environmental stochasticity, synchrony of per capita growth rates is lower when demographic stochasticity is strong (Fig. 3, top panels, orange tones).
The desynchronizing effect of demographic stochasticity on per capita growth rates is strongest in small populations (small landscapes) for all communities (Fig. 3, top panels).
Demographic stochasticity had a weaker effect on synchrony of percent cover; only in the Arizona community does strong demographic stochasticity counteract the synchronizing effect of the environment (Fig. 3; bottom panels).

Since species interactions are weak and demographic stochasticity only matters in small populations, the synchrony of species in monoculture (without interspecific interactions) should predict the synchrony of species in polyculture (with interspecific interactions).
For all five communities and for percent cover and per capita growth rates, the synchrony of species in monoculture is a near-perfect predictor of species synchrony in polyculture (Fig. 4A).
However, the synchrony of species' low-density growth rates, a more accurate measure of a species' environmental response, was a less accurate predictor of species synchrony in polyculture (Fig. 4B).

Discussion
----------
Temporal asynchrony among interacting populations can stabilize ecosystem-level function and is influenced by inter and intraspecific competition, demographic stochasticity, and environmental fluctuations [@Loreau2013].
We used multi-species population models applied to five semiarid plant communities to determine the relative influence of the drivers of community synchrony.
Our study produced three main findings that were consistent across five plant communities: (1) interspecific interactions were weak and therefore had little impact on community synchrony; (2) demographic stochasticity decreased community synchrony, as expected by theory, and its effect was largest in small populations; and (3) environmental fluctuations increased community synchrony since species-specific responses to the environment were positively, but not completely, correlated.
Thus, our results are in agreement with theoretical expectations: when species interactions and demographic stochasticity are weak, community synchrony approximately equals the synchrony of species' responses to the environment.

### Interspecific interactions had little impact on community synchrony
We expected community synchrony of per capita growth rates to decrease and synchrony of plant cover to increase when we removed interspecific interactions.
In the absence of demographic stochasticity, community synchrony was virtually indistinguishable between simulations with and without interspecific interactions for both per capita growth rates and percent cover (Fig. 2).
The only notable exception is the Idaho community where, as expected, synchrony of percent cover increased when we removed interspecific interactions.
Instead, we observed no effect of removing interspecific interactions in the presence of environmental fluctuations, regardless of the presence or absence of demographic stochasticity (Figs. 2,3).
When we also removed environmental fluctuations, removing interspecific interactions decreased synchrony of per capita growth rates in three of our five communities and increased synchrony of per capita growth rates in two communities (Fig. 3).
This result is in contrast to a large body of theoretical work that predicts a strong role for competition in creating compensatory dynamics and a recent empirical analysis [@Gross2014].  

### Demographic stochasticity decreases synchrony
In communities where environmental forcing and community regulation by inter and intraspecific density-dependence are weak, species should fluctuate independently and community synchrony is expected to equal the inverse of the number of species in the community (1/*S*).
Such independent fluctuations are expected for per capita growth rates regardless of population sizes, whereas synchrony of percent cover should trend toward one (perfect synchrony) as population sizes increase and the effect of demographic stochasticity is diminished.
Our results conform to expectations: for each community except Arizona, community synchrony of per capita growth rates are approximately equal to 1/*S* when only demographic stochasticity is acting (Fig. 3; top panels, dark purple lines) and synchrony of percent cover starts at approximately 1/*S* and increases linearly as population sizes increase (Fig. 3; bottom panels, dark purple lines).
In the Arizona community, synchrony of per capita growth rates is approximately 1/*S* as expected, but synchrony of precent cover does not increase with population size (Fig. 3f).
This could indicate that intraspecific density-dependence is abnormally strong in the Arizona community, relative to the other communities we studied.
Strong intraspecific density-dependence for the two species in the Arizona community would limit population size regardless of landscape size.
Therefore, populations would not grow large enough to limit the desynchronizing effect of demographic stochasticity.
In other words, if there is no relationship between landscape size and population size due to strong density-dependence, the effect of demgographic stochasticity will not lessen.

Demographic stochasticity is able to partially counteract the synchronizing effects of environmental fluctuations and interspecific interactions on per capita growth rates, but only when populations are small.
Even in small populations, however, demographic stochasticity is not a strong enough force to induce independent fluctuations.
These results cofirm the theoretical argument by @Loreau2008a that independent fluctuations among interacting species in a non-constant environment should be rare.
Only in the Idaho community does synchrony of per capita growth rates approach 1/*S* in a non-constant environment (Fig. 3x).
This is most likely due to the strong effect of demographic stochasticity on the shrub *Artemisia tripartita* since even a 5 $\text{m}^2$ quadrat would only contain a few individuals of that species.

### Environmental fluctuations drive community synchrony
In large populations where interspecific interactions are weak, synchrony is expected to be driven exclusively by environmental fluctuations.
Under such conditions community synchrony should approximately equal the synchrony of species' responses to the environment.
We find that environmental fluctuations drive synchrony of per capita growth rates and plant percent cover in all five communities.
Removing environmental fluctuations consistently reduced synchrony (Fig. 3) and the synchrony of species environmental responses was a strong, but not perfect, predictor of community synchrony (Fig. 4).
Likewise, removing interspecific interactions resulted in no discernable change in community synchrony of per capita growth rates (Fig. 2).
The lack of change indicates a strong correlation between species growing in polyculture (with interspecific interactions) and in monoculture (without interspecific interactions).
If we consider sychrony in monoculture to represent the synchrony of species' responses to the environment, then our results lead to only one conclusion: environmental fluctuations are the primary driver of community synchrony.
This is unsurprising since we know that species interactions are weak in these communities.
More surprising is that our results appear to be quite general: across five arid-to-subhumid grasslands community synchrony is almost soley due to environmental fluctuations since interspecific interactions are weak.
Given accumulating evidence that niche differences in natural communities are large [reviewed in @Chu2015], and thus species interactions are likely to be weak, our results are likely very general when applied to natural grasslands.

A challenge to the generality of our results is that a recent analysis of several biodiversity-ecosystem function experiments came to a completely opposing conclusion: competition drives species synchrony in grasslands [@Gross2014].
@Gross2014 found that temporal asynchrony among plant species in four experiments was driven by interspecific competition that counteracted the synchronizing effect of environmental fluctuations.
This is surprising given the extremely weak species interactions we estimated.
But the apparent inconsistency between our results and those of @Gross2014 disappears when we consider the differences between our studies.
Gross et al.'s results are based on experimentally-assembled communities that have coexisted for, at most, 11 years.
In contrast, the natural communities we studied consist of species that have coexisted for decades and have virtually zero niche overlap [@Chu2015].
In theory, species interactions should weaken through time as community assembly progesses [@Kokkoris1999], meaning that in biodiversity-ecosystem function experiments community assembly processes that can result in competitive exclusion may yet to have been realized.
Therefore, such communities may be highly influenced by transient, but strong, interspecific competition that can mask the synchronizing effects of the environment.
This also leads to the prediction that community synchrony is driven by competition in recently assembled communities, while synchrony is driven by environmental fluctuations in communities that have undergone extensive species sorting.
In other words, in the absence of disturbance and invasion, the dominant driver of community synchrony should shift from competition to environmental fluctuations through time.
One way to test this prediction is to continue collecting data from biodiversity-ecoystem function experiments and conduct the analysis of @Gross2014 every few years.

Our analysis also contributes to mounting evidence on the importance of functional diversity for maintaining temporal stability via species asynchrony [@Reich2012; @Polley2013].
Functional traits define how a species will respond to its environment.
Therefore, greater functional differences among species should lead to lower correlations in species' responses to the environment.
We found evidence for the negative effect of functional diversity on community synchrony: community synchrony was lowest Idaho (Table 2, Fig. 2); the only community that contained two life forms (one shrub, three perennial grasses).
In fact, when we ran simulations with the shrub removed, synchrony of the Idaho community increased substantially and was similar to synchrony in the Kansas community, which also contained three species.
Functional diversity is especially important in communities with weak interspecific interactions where synchrony depends soley on species' environmental responses.
Adding species to such communities will always decrease synchrony, and increase temporal stability, so long as the synchrony of species' environmental response is less than 1 [@Loreau2008a; @Loreau2013].
But functionally diverse suites of species will have the lowest synchrony of environmental responses, and thus lowest community synchrony and highest stability.

Conclusion
----------
We used empirically-based, multi-species population models to test predictions arising from theory on the drivers of species synchrony.
Our results are consistent across five perennial plant communities and show that community-wide synchrony is predominantly driven by environmental forcing.
Thus, we find support for Loreau and de Mazancourt's (2008) prediction that community-wide synchrony of per capita growth rates should approximately equal the synchrony of species' environmental responses when demographic stochasticity and species interactions are weak.
We have reason to believe that our results are quite general since many studies report large niche differences, and thus weak interactions, in plant communities.
However, our results are in contrast to a recent analysis of several biodiversity-ecosystem function experiments showing that competition drives community synchrony.
We conclude that the difference between the Gross et al. (2014) study and our own is due to community assembly processes: recently assembled communities, such as experimental plots, may exhibit strong species interactions that will weaken over time [@Kokkoris1999].
Viewing community synchrony through the lens of community assembly processes may provide a way to reconcile inconsistent observations on the biotic and abiotic forces that jointly drive community dynamics.


Ackowledgements
---------------
This work was funded by the National Science Foundation through a Postdoctoral Research Fellowship in Biology to ATT (DBI-1400370) and a CAREER award to PBA (DEB-1054040). CdM and ML were supported by the TULIP Laboratory of Excellence (ANR-10-LABX-41). We thank the original mappers of the permanent quadrats at each site and the digitizers in the Adler lab, without whom this work would not have been possible. Compute, storage and other resources from the Division of Research Computing in the Office of Research and Graduate Studies at Utah State University are gratefully acknowledged.

\setlength{\parindent}{0ex}
\newpage{}


Tables
------

\singlespacing

Table 1: Site descriptions and focal species.
\footnotesize

| Site Name | Biome | Location (Lat, Lon) | Obs. Years | Species |
| --------- | ----- | ------------------- | ---------- | ------- |
| Arizona | Sonoran Desert | 31&deg;50' N, 110&deg;53' W | 1915-1933 | *Bouteloua eriopoda* |
| | | | | *Bouteloua rothrockii* |
| Idaho | Sagebrush steppe | 44.2&deg; N, 112.1&deg; W | 1926-1957 | *Artemisia tripartita* |
| | | | | *Pseudoroegneria spicata* |
| | | | | *Hesperostipa comata* |
| | | | | *Poa secunda* |
| Kansas | Southern mixed prairie | 38.8&deg; N, 99.3&deg; W | 1932-1972 | *Bouteloua curtipendula* |
| | | | | *Bouteloua hirsuta* |
| | | | | *Schizachyrium scoparium* |
| Montana | Northern mixed prairie | 46&deg;19' N, 105&deg;48' W | 1926-1957 | *Bouteloua gracilis* |
| | | | | *Hesperostipa comata* |
| | | | | *Pascopyrum smithii* |
| | | | | *Poa secunda* |
| New Mexico | Chihuahuan Desert | 32.62&deg; N, 106.67&deg; W | 1915-1950 | *Bouteloua eriopoda* |
| | | | | *Sporobolus flexuosus* |

\normalsize

\pagebreak{}

```{r load_libs, echo=FALSE, message=FALSE, warning=FALSE}
library(communitySynchrony)
library(plyr)
library(reshape2)
library(synchrony)
library(ggplot2)
library(xtable)
library(gridExtra)
library(RColorBrewer)
```

```{r get_all_data, echo=FALSE, eval=T}
site <- "Kansas"
spp_list <- c("BOCU","BOHI","SCSC")
num_spp <- length(spp_list)
ks_data <- data.frame(quad=NA, year=NA, totCover=NA, species=NA)
for(dospp in 1:num_spp){ #loop through species to read in data
  spp_now <- spp_list[dospp]
  quad_file <- paste("../data/", site,"/",spp_now,"/quadratCover.csv",sep="")
  spp_data <- read.csv(quad_file)
  spp_data$species <- spp_now
  ks_data <- rbind(ks_data, spp_data)
} #end species looping for raw data
ks_data <- ks_data[2:nrow(ks_data),] #remove first NA row

tmp1<-which(ks_data$quad_data=="q25" & (ks_data$year<35 | ks_data$year>62))
tmp2<-which(ks_data$quad_data=="q27")
tmp3<-which(ks_data$quad=="q28")
tmp4<-which(ks_data$quad=="q30")
tmp5<-which(ks_data$quad=="q31" & (ks_data$year<35 | ks_data$year>39))
tmp6<-which(ks_data$quad=="q32" & (ks_data$year<35 | ks_data$year>41))
tmp<-c(tmp1,tmp2,tmp3,tmp4,tmp5,tmp6)
ks_data<-ks_data[-tmp,]

# exclude the records later than 1968, to keep the same random year effect...
ks_data<-subset(ks_data,year<68)


site <- "Idaho"
spp_list <- sort(c("PSSP","HECO","POSE","ARTR"))
num_spp <- length(spp_list)
id_data <- data.frame(quad=NA, year=NA, totCover=NA, species=NA)
for(dospp in 1:num_spp){ #loop through species to read in data
  spp_now <- spp_list[dospp]
  quad_file <- paste("../data/", site,"/",spp_now,"/quadratCover.csv",sep="")
  spp_data <- read.csv(quad_file)
  spp_data$species <- spp_now
  id_data <- rbind(id_data, spp_data)
} #end species looping for raw data
id_data <- id_data[2:nrow(id_data),] #remove first NA row
# id_data <- subset(id_data, species!="ARTR") #take out the shrub


site <- "Montana"
spp_list <- sort(c("BOGR","HECO","PASM","POSE"))
num_spp <- length(spp_list)
mt_data <- data.frame(quad=NA, year=NA, totCover=NA, species=NA)
for(dospp in 1:num_spp){ #loop through species to read in data
  spp_now <- spp_list[dospp]
  quad_file <- paste("../data/", site,"/",spp_now,"/quadratCover.csv",sep="")
  spp_data <- read.csv(quad_file)
  spp_data$species <- spp_now
  mt_data <- rbind(mt_data, spp_data)
} #end species looping for raw data
mt_data <- mt_data[2:nrow(mt_data),] #remove first NA row



site <- "NewMexico"
spp_list <- sort(c("BOER","SPFL"))
num_spp <- length(spp_list)
nm_data <- data.frame(quad=NA, year=NA, totCover=NA, species=NA)
for(dospp in 1:num_spp){ #loop through species to read in data
  spp_now <- spp_list[dospp]
  quad_file <- paste("../data/", site,"/",spp_now,"/quadratCover.csv",sep="")
  spp_data <- read.csv(quad_file)
  spp_data$species <- spp_now
  nm_data <- rbind(nm_data, spp_data)
} #end species looping for raw data
nm_data <- nm_data[2:nrow(nm_data),] #remove first NA row



site <- "Arizona"
spp_list <- sort(c("BOER","BORO"))
num_spp <- length(spp_list)
az_data <- data.frame(quad=NA, year=NA, totCover=NA, species=NA)
for(dospp in 1:num_spp){ #loop through species to read in data
  spp_now <- spp_list[dospp]
  quad_file <- paste("../data/", site,"/",spp_now,"/quadratCover.csv",sep="")
  spp_data <- read.csv(quad_file)
  spp_data$species <- spp_now
  az_data <- rbind(az_data, spp_data)
} #end species looping for raw data
az_data <- az_data[2:nrow(az_data),] #remove first NA row
```

```{r get_all_synch, echo=FALSE, include=TRUE, eval=T, cache=FALSE}
out_ks <- get_comm_synchrony(ts_data = ks_data)
out_id <- get_comm_synchrony(ts_data = id_data)
out_mt <- get_comm_synchrony(ts_data = mt_data)
out_nm <- get_comm_synchrony(ts_data = nm_data)
out_az <- get_comm_synchrony(ts_data = az_data)
```


```{r synchrony_table, echo=FALSE, include=TRUE, results='asis', message=FALSE, eval=T, cache=FALSE}
get_table_metrics <- function(output){
  tmp <- output
  exp_tmp <- round(tmp$pgr_expected_synch_ind_flucts, 2)
  obs_tmp <- round(as.numeric(tmp$pgr_synchrony[1]), 2)
  demo_tmp <- obs_tmp - exp_tmp
  exp_cover <- round(as.numeric(tmp$cover_expected_synch_ind_flucts), 2)
  obs_cover <- round(as.numeric(tmp$abund_synchrony[1]), 2)
  demo_cover <- obs_cover - exp_cover
  plant_size <- tmp$avg_size
  cover_var <- tmp$variability
  return(c(obs_tmp, exp_tmp, demo_tmp, obs_cover, exp_cover, 
           demo_cover, cover_var))
}

table_data <- as.data.frame(rbind(get_table_metrics(out_ks),
                                  get_table_metrics(out_id),
                                  get_table_metrics(out_mt),
                                  get_table_metrics(out_nm),
                                  get_table_metrics(out_az)))
table_data$Site <- c("Kansas", "Idaho", "Montana", "New Mexico", "Arizona")
table_data <- table_data[,c("Site", "V1", "V2", "V3", "V4", "V5", "V6", "V7")]
table_data$spp <- c(length(unique(ks_data$species)),
                    length(unique(id_data$species)),
                    length(unique(mt_data$species)),
                    length(unique(nm_data$species)),
                    length(unique(az_data$species)))
# colnames(table_data) <- c("Site",
#                           "$\\phi_{r}$", 
#                           "$\\text{E}(\\phi_{r})$",
#                           "Species richness")
colnames(table_data) <- c("Site",
                          "$\\phi_{r}$", 
                          "$\\text{E}(\\phi_{r})$", 
                          "$\\text{E}(\\sigma_{r,c} + \\sigma_{r,e})$",
                          "$\\phi_{C}$", 
                          "$\\text{E}(\\phi_{C})$",
                          "$\\text{E}(\\sigma_{C,c} + \\sigma_{C,e})$",
                          "CV of Total Cover",
                          "Species richness")
# table_data[,3] <- round(1/table_data[,ncol(table_data)],2) # reset expected sybchrony to 1/S
# table_data[,4] <- table_data[,2] - table_data[,3] # calculate obs - exp synchrony

synch_cap <- "Observed and expected synchrony among species' per capita growth rates and expected effect of demographic stochasticity on observed synchrony. Species richness values reflect the number of species analyzed from the community, not the actual richness."
print(xtable(table_data, caption = synch_cap),
      caption.placement="top",
      include.rownames = F, 
      sanitize.colnames.function = identity,
      comment=FALSE,
      size="footnotesize",
      floating.environment="sidewaystable")
```

\pagebreak{}

Figures
-------

```{r time_series_fig, echo=FALSE, include=TRUE, fig.width=8.5, fig.height=4, fig.cap="Observed time series of mean percent cover (averaged over quadrats for each year) and per capita growth rates for each species at each site. Panels are labeled by site codes: AZ = Arizona, ID = Idaho, KS = Kansas, MT = Montana, and NM = New Mexico.", eval=F}
out_ks$percent_cover$site <- "Kansas"
out_id$percent_cover$site <- "Idaho"
out_mt$percent_cover$site <- "Montana"
out_nm$percent_cover$site <- "New Mexico"
out_az$percent_cover$site <- "Arizona"
cover_data <- rbind(out_ks$percent_cover, out_id$percent_cover,
                    out_mt$percent_cover, out_nm$percent_cover, 
                    out_az$percent_cover)

out_ks$growth_rates$site <- "Kansas"
out_id$growth_rates$site <- "Idaho"
out_mt$growth_rates$site <- "Montana"
out_nm$growth_rates$site <- "New Mexico"
out_az$growth_rates$site <- "Arizona"
pgr_data <- rbind(out_ks$growth_rates, out_id$growth_rates,
                  out_mt$growth_rates, out_nm$growth_rates, 
                  out_az$growth_rates)
all_spp <- unique(pgr_data$species)
color_match <- data.frame(species = all_spp,
                          color = brewer.pal(12,"Paired"))
pgr_data <- merge(pgr_data, color_match, by = "species")
cover_data <- merge(cover_data, color_match, by="species")

### Create labelling dataframe
site_list <- unique(cover_data$site)
textdf <- data.frame(species=NA, year=NA, tot_cover=NA, num_obs=NA, site=NA, color=NA)
for(dosite in site_list){
  tmp <- subset(cover_data, site==dosite)
  if(dosite=="Kansas"){
    maxyr <- min(unique(tmp$year))
    textdf <- rbind(textdf,tmp[tmp$year == maxyr, ])
  }
  if(dosite!="Kansas"){
    maxyr <- max(unique(tmp$year))
    textdf <- rbind(textdf,tmp[tmp$year == maxyr, ])
    textdf$year <- textdf$year+2
  }
}
textdf <- textdf[2:nrow(textdf),]

### Change site to two-letter codes
site_list <- sort(unique(cover_data$site))
sitecode <- c("AZ", "ID", "KS", "MT", "NM")
for(i in 1:length(site_list)){
  cover_data[cover_data$site==site_list[i], "site"] <- sitecode[i]
  pgr_data[pgr_data$site==site_list[i], "site"] <- sitecode[i]
}

cover_plot <- ggplot(data=cover_data, aes(x=(year+1900), y=tot_cover, color=color))+
                geom_line(alpha=0.25)+
                geom_point(size=2)+
                facet_grid(site~., scales = "free_y")+
                guides(color=FALSE)+
                ylab("Mean Percent Cover")+
                xlab("Year")+
                scale_color_manual(values = brewer.pal(12,"Paired"))+
                theme_bw()

pgr_plot <- ggplot(data=pgr_data, aes(x=(year+1900), y=pgr, color=color))+
              geom_line(alpha=0.25)+
                geom_point(size=2)+
              facet_grid(site~.)+
              guides(color=FALSE)+
              ylab("Per Capita Growth Rate")+
              xlab("Year")+
              scale_color_manual(values = brewer.pal(12,"Paired"))+
              theme_bw()
full_plot <- grid.arrange(cover_plot, pgr_plot, ncol=2)
```


```{r concept_fig, echo=FALSE, fig.cap="Conceptual figure outlining the effects of interspecific interactions and environmental stochasticity in large populations where demographic stochasticity is effectively absent (A) and in populations of varying size where demographic stochasticity is present (B).", eval=F}
library(png)
library(grid)
img <- readPNG("./components/synchrony_conceptual_fig.png")
grid.raster(img)
```

```{r read_data, echo=FALSE, eval=T}
output_list <- readRDS("../results/ipm_comp_nocomp_sims.RDS")
mlist <- melt(output_list)
```

```{r figure_1, echo=FALSE, fig.cap="Observed (vertical dashed lines) and IPM simulated (solid density curves) synchrony of species per capita growth rates based on changes in percent cover. Density curves come from 100 random contiguous sections from 2,000 iteration IPM runs, where the length of each randomly selected section is equal to the numnber of observation years for each data set.", fig.width=6, fig.height=6, fig.width=3, eval=T}
nyrs <- c(max(out_az$stability$num_observations),
          max(out_id$stability$num_observations),
          max(out_ks$stability$num_observations),
          max(out_mt$stability$num_observations),
          max(out_nm$stability$num_observations))

boots <- 100
sites <- sort(table_data$Site)
sites[5] <- "NewMexico"
synch <- matrix(NA, boots, length(sites))

for(do_site in 1:length(sites)){
  full_ipm_outs <- subset(mlist, L2=="ENVINTER")
  site_ipm <- subset(full_ipm_outs, L1==sites[do_site])
  colnames(site_ipm) <- c("year", "species", "cover", "L1", "L2")
  # if(sites[do_site]=="Idaho") site_ipm <- subset(site_ipm, Var2!="ARTR")
  species_list <- unique(site_ipm$species)
  num_spp <- length(species_list)
  for(i in 1:boots){
    begin_year <- sample(x = 1:(max(site_ipm$year)-nyrs[do_site]), 1)
    end_year <- begin_year+nyrs[do_site]
    tmp <- subset(site_ipm, year %in% begin_year:end_year)
    tmp2 <- dcast(tmp, year~species, value.var = "cover")

    # caclulate observed growth rates
    # create lagged data frame to only get observed yearly transitions
    lag_df <- tmp2
    lag_df$lagyear <- lag_df$year+1
    colnames(lag_df)[2:(num_spp+1)] <- paste0(colnames(lag_df)[2:(num_spp+1)],"_t0") 
    
    # merge the lag df with observed
    rm_col <- which(colnames(lag_df)=="year")
    merged_df <- merge(tmp2, lag_df[,-rm_col], by.x = "year", by.y="lagyear")
    transitions <- nrow(merged_df)
    obs_gr <- matrix(nrow=transitions, ncol=num_spp)
    name_ids1 <- which(colnames(merged_df) %in% species_list)
    name_ids2 <- which(colnames(merged_df) %in% paste(species_list, "_t0", sep=""))
    for(ii in 1:transitions){
      obs_gr[ii,] <- as.numeric(log(merged_df[ii,name_ids1]/merged_df[ii,name_ids2]))
    }
    synch[i,do_site] <- as.numeric(community.sync(obs_gr)[1])
  }
}

colnames(synch) <- sites
synch_df <- melt(synch)

obs_pgr_df <- c(as.numeric(out_az$pgr_synchrony[1]),
                as.numeric(out_id$pgr_synchrony[1]),
                as.numeric(out_ks$pgr_synchrony[1]),
                as.numeric(out_mt$pgr_synchrony[1]),
                as.numeric(out_nm$pgr_synchrony[1]))
obs_pgr_df <- data.frame(pgr_synch=obs_pgr_df,
                         Var2=sites)

ggplot()+
  geom_line(data=synch_df, aes(x=value, color=Var2), stat="density", adjust=2)+
  geom_vline(data=obs_pgr_df, aes(xintercept=pgr_synch, color=Var2), linetype=2)+
  facet_wrap("Var2", ncol=1)+
  scale_color_manual(values = c("grey45", "steelblue", "slateblue4", "darkorange", "purple"))+
  guides(color=FALSE)+
  xlab("Community Synchrony")+
  ylab("Estimated Probability Density")+
  theme_bw()
```

\pagebreak{}

\begin{figure}[!ht]
  \centering
      \includegraphics{./components/ipm_pgr_plot.png}
  \caption{Community synchrony of per capita growth rates (points, solid lines) and percent cover (triangles, dashed lines) from IPM simulations with (INTER) and without (NoINTER) interspecific interactions. `F' in x-axis labels refers to a fluctuating environment. Errorbars represent the upper and lower 90th quantiles of synchrony from 100 random contiguous 50 year sections from a 2,000 iteration IPM run. Points represent the mean synchrony across the 100 sections.}
\end{figure}

\pagebreak{}

\begin{figure}[!ht]
  \centering
      \includegraphics{./components/ibm_sims_fig.png}
  \caption{Community synchrony of per capita growth rates (top panels) and percent cover (bottom panels) from spatially-explicit IBM simulations. Points represent replicate IBM simulations (out of 50 possible) in which no species went extinct. Lines show linear fits between plot size (proxy for population size) and species synchrony. Demographic stochasticity plays a large role in small populations (small plot sizes) and a smaller role in large populations (large plot sizes). Simulation type codes: C = constant environment, F = fluctuating environment, INTER = interspecific interactions included, NoINTER = interspecific interactions excluded (set to zero).}
\end{figure}

<!--
\pagebreak{}

\begin{figure}[!ht]
  \centering
      \includegraphics{./components/envresp_vs_ipmsynch.png}
  \caption{Average synchrony of IPM-simulated per capita growth rates (from 13 year sections) as a function of the average synchrony of the vital rate random year effects for each site. Community sychrony is expected to approximately equal the synchrony of species' environmental responses in the absence of demographic stochasticity and strong interspecific interactions. The synchrony of species' random year effects across vital rates is a strong ($\text{R}^2$ = 0.67), but not perfect, predictor of community synchrony. Points are labeled by site codes: AZ = Arizona, ID = Idaho, KS = Kansas, MT = Montana, and NM = New Mexico.}
\end{figure}
-->
\pagebreak{}

\begin{figure}[!ht]
  \centering
      \includegraphics{./components/poly_vs_mono_synch.png}
  \caption{Synchrony of communities simulated without interspecific interactions (monoculture) versus synchrony of communities simulated with interspecific interactions (polyculture). We used the same sequence of random year effects for both simulations (mono and polyculture) to mimic biodiversity-ecosystem function experiments. The dashed line is the line of equality.}
\end{figure}

\pagebreak{}

```{r time_series, eval=FALSE, echo=FALSE, fig.cap="Example time series from the simulations.", eval=F}
ggplot(mlist, aes(x=year, y=(cover*100), color=species))+
  geom_line()+
  facet_grid(L1~L2, scale="free")
```

\pagebreak{}

References
----------